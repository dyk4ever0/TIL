<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Introduction to Docker | Today I Learned</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/TIL/logo.png">
    <meta name="description" content="Doyeon&#39;s Personal Wiki (Today I Learned)">
    
    <link rel="preload" href="/TIL/assets/css/0.styles.093cd7c6.css" as="style"><link rel="preload" href="/TIL/assets/js/app.b135f39f.js" as="script"><link rel="preload" href="/TIL/assets/js/2.3418f87f.js" as="script"><link rel="preload" href="/TIL/assets/js/1.edb52fe5.js" as="script"><link rel="preload" href="/TIL/assets/js/26.f668a394.js" as="script"><link rel="prefetch" href="/TIL/assets/js/10.60de4e42.js"><link rel="prefetch" href="/TIL/assets/js/11.ea4e7555.js"><link rel="prefetch" href="/TIL/assets/js/12.dfb13e3d.js"><link rel="prefetch" href="/TIL/assets/js/13.7022feaa.js"><link rel="prefetch" href="/TIL/assets/js/14.77c3c90c.js"><link rel="prefetch" href="/TIL/assets/js/15.5b29b336.js"><link rel="prefetch" href="/TIL/assets/js/16.9b245c3c.js"><link rel="prefetch" href="/TIL/assets/js/17.82105c7e.js"><link rel="prefetch" href="/TIL/assets/js/18.9bfbf01f.js"><link rel="prefetch" href="/TIL/assets/js/19.d6620149.js"><link rel="prefetch" href="/TIL/assets/js/20.015f06d4.js"><link rel="prefetch" href="/TIL/assets/js/21.5f69e892.js"><link rel="prefetch" href="/TIL/assets/js/22.5e971a1f.js"><link rel="prefetch" href="/TIL/assets/js/23.54ab904a.js"><link rel="prefetch" href="/TIL/assets/js/24.fe9404ad.js"><link rel="prefetch" href="/TIL/assets/js/25.88a2e5da.js"><link rel="prefetch" href="/TIL/assets/js/27.017764da.js"><link rel="prefetch" href="/TIL/assets/js/28.8cb77243.js"><link rel="prefetch" href="/TIL/assets/js/29.6f8fa133.js"><link rel="prefetch" href="/TIL/assets/js/3.dc5f2543.js"><link rel="prefetch" href="/TIL/assets/js/30.a3a19844.js"><link rel="prefetch" href="/TIL/assets/js/31.b16ba238.js"><link rel="prefetch" href="/TIL/assets/js/32.67433567.js"><link rel="prefetch" href="/TIL/assets/js/4.c8af7e76.js"><link rel="prefetch" href="/TIL/assets/js/5.0a0a0287.js"><link rel="prefetch" href="/TIL/assets/js/6.2e00e0e2.js"><link rel="prefetch" href="/TIL/assets/js/7.6f3206c8.js"><link rel="prefetch" href="/TIL/assets/js/vendors~docsearch.cf079a49.js">
    <link rel="stylesheet" href="/TIL/assets/css/0.styles.093cd7c6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/TIL/" class="home-link router-link-active"><!----> <span class="site-name">Today I Learned</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/dyk4ever0/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://dyks-organization.gitbook.io/undefined/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/dyk4ever0/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://dyks-organization.gitbook.io/undefined/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>DevOps</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/TIL/DevOps/docker.html" aria-current="page" class="active sidebar-link">Introduction to Docker</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/TIL/DevOps/docker.html#hello-world" class="sidebar-link">Hello world</a></li><li class="sidebar-sub-header"><a href="/TIL/DevOps/docker.html#빌드-build" class="sidebar-link">빌드(Build)</a></li><li class="sidebar-sub-header"><a href="/TIL/DevOps/docker.html#돌리기-run" class="sidebar-link">돌리기 (Run)</a></li><li class="sidebar-sub-header"><a href="/TIL/DevOps/docker.html#디버그-debug" class="sidebar-link">디버그(Debug)</a></li></ul></li><li><a href="/TIL/DevOps/vupress-github-actions.html" class="sidebar-link">GitHub Actions로 Vuepress 배포하기</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>DataBase</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>gitbook-pages</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="introduction-to-docker"><a href="#introduction-to-docker" class="header-anchor">#</a> Introduction to Docker</h1> <h2 id="hello-world"><a href="#hello-world" class="header-anchor">#</a> Hello world</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 'hello-world'란 컨테이너 돌리기. 로컬에 있으면 그거 돌리고 없으면 Docker hub에서 찾아서 pull받음</span>
$ <span class="token function">docker</span> run hello-world
Unable to <span class="token function">find</span> image <span class="token string">'hello-world:latest'</span> locally
latest: Pulling from library/hello-world
9db2ca6ccae0: Pull complete
Digest: sha256:4b8ff392a12ed9ea17784bd3c9a8b1fa3299cac44aca35a85c90c5e3c7afacdc
Status: Downloaded newer image <span class="token keyword">for</span> hello-world:latest

Hello from Docker<span class="token operator">!</span>
This message shows that your installation appears to be working correctly.

<span class="token comment"># 컨테이너 이미지들 보기</span>
$ <span class="token function">docker</span> images
REPOSITORY     TAG      IMAGE ID       CREATED       SIZE
hello-world    latest   1815c82652c0   <span class="token number">6</span> days ago    <span class="token number">1.84</span> kB

<span class="token comment"># 돌고 있는 컨테이너 보기. 아까 hello-world는 바로 exit되서 안나온다</span>
$ <span class="token function">docker</span> <span class="token function">ps</span>

<span class="token comment"># 끝난 컨테이너도 보기</span>
$ <span class="token function">docker</span> <span class="token function">ps</span> <span class="token parameter variable">-a</span>
CONTAINER ID      IMAGE           COMMAND      <span class="token punctuation">..</span>.     NAMES
6027ecba1c39      hello-world     <span class="token string">&quot;/hello&quot;</span>     <span class="token punctuation">..</span>.     elated_knuth
358d709b8341      hello-world     <span class="token string">&quot;/hello&quot;</span>     <span class="token punctuation">..</span>.     epic_lewin
</code></pre></div><h2 id="빌드-build"><a href="#빌드-build" class="header-anchor">#</a> 빌드(Build)</h2> <p>간단한 노드를 베이스로 하는 도커 이미지를 만들어보자!</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">mkdir</span> <span class="token builtin class-name">test</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> <span class="token builtin class-name">test</span>

<span class="token function">cat</span> <span class="token operator">&gt;</span> Dockerfile <span class="token operator">&lt;&lt;</span>EOF
</code></pre></div><p>Dockerfile 작성하기</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 노드 버전6을 가리키는 오피셜 도커 이미지를 부모 이미지로 함</span>
FROM node:6

<span class="token comment"># 워킹 디렉토리 설정</span>
WORKDIR /app

<span class="token comment"># 현재 디렉토리의 컨텐츠를 /app에 복사</span>
ADD <span class="token builtin class-name">.</span> /app

<span class="token comment"># 컨테이너에 80번 포트를 뚫어서 접근 가능하도록</span>
EXPOSE <span class="token number">80</span>

<span class="token comment"># app.js를 노드로 돌린다</span>
CMD <span class="token punctuation">[</span><span class="token string">&quot;node&quot;</span>, <span class="token string">&quot;app.js&quot;</span><span class="token punctuation">]</span>
EOF
</code></pre></div><p>app.js 만들기. 간단히 80번 포트에 hello world 띄워주는 HTTP Server</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> hostname <span class="token operator">=</span> <span class="token string">'0.0.0.0'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> port <span class="token operator">=</span> <span class="token number">80</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span>statusCode <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
      res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/plain'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'Hello World\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> hostname<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Server running at http://%s:%s/'</span><span class="token punctuation">,</span> hostname<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

process<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'SIGINT'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Caught interrupt signal and will exit'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 도커 이미지 빌드하기. -t는 태그달기, node-app이란 이름의 이미지고 tag는 0.1이라는것. 태그는 도커 이미지 빌드할때 꼭 적는게 좋다. 안적으면 latest란 이름으로 만들어지는데 최신껄 구별하기 어려움.</span>
$ <span class="token function">docker</span> build <span class="token parameter variable">-t</span> node-app:0.1 <span class="token builtin class-name">.</span>
Sending build context to Docker daemon  <span class="token number">3</span>.072kB
Step <span class="token number">1</span>/5 <span class="token builtin class-name">:</span> FROM node:6
<span class="token number">6</span>: Pulling from library/node
ab1fc7e4bf91: Pull complete
35fba333ff52: Pull complete
f0cb1fa13079: Pull complete
3d1dd648b5ad: Pull complete
49f7a0920ce1: Pull complete
1d199f738c5f: Pull complete
1f5b9192d3e9: Pull complete
6b45c21448e5: Pull complete
Digest: sha256:b567cbc706f6d8f498adc0b056f3e904043478a2c814124af62fc9f18ffcb9c2
Status: Downloaded newer image <span class="token keyword">for</span> node:6
 ---<span class="token operator">&gt;</span> 554a99f911d9
Step <span class="token number">2</span>/5 <span class="token builtin class-name">:</span> WORKDIR /app
Removing intermediate container 613e84f7c38e
 ---<span class="token operator">&gt;</span> 19526c64979a
Step <span class="token number">3</span>/5 <span class="token builtin class-name">:</span> ADD <span class="token builtin class-name">.</span> /app
 ---<span class="token operator">&gt;</span> 36ec7ba933e7
Step <span class="token number">4</span>/5 <span class="token builtin class-name">:</span> EXPOSE <span class="token number">80</span>
 ---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> 51c2424677d4
Removing intermediate container 51c2424677d4
 ---<span class="token operator">&gt;</span> a07151f17077
Step <span class="token number">5</span>/5 <span class="token builtin class-name">:</span> CMD <span class="token punctuation">[</span><span class="token string">&quot;node&quot;</span>, <span class="token string">&quot;app.js&quot;</span><span class="token punctuation">]</span>
 ---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> fd7b7d36c33a
Removing intermediate container fd7b7d36c33a
 ---<span class="token operator">&gt;</span> 1b627525501c
Successfully built 1b627525501c
Successfully tagged node-app:0.1

<span class="token comment"># 컨테이너 이미지들 보기. node-app은 node를 베이스로 한 이미지다. node를 지우려면 node-app을 먼저 지워야 함. node:slim이나 node:alpine은 용량이 작은 이미지니 잘 골라서 써라.</span>
$ <span class="token function">docker</span> images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
node-app            <span class="token number">0.1</span>                 1b627525501c        <span class="token number">2</span> minutes ago       882MB
<span class="token function">node</span>                <span class="token number">6</span>                   554a99f911d9        <span class="token number">3</span> days ago          882MB
hello-world         latest              fce289e99eb9        <span class="token number">3</span> weeks ago         <span class="token number">1</span>.84kB
</code></pre></div><h2 id="돌리기-run"><a href="#돌리기-run" class="header-anchor">#</a> 돌리기 (Run)</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># --name 플래그를 붙여 my-app이라고 이름을 지어줄 수 있다. -p 플래그로는 호스트 포트 4000을 컨테이너 포트 80으로 맵해줄 수 있다(아까 node-app을 80으로 띄웠으니까). 이젠 내 로컬에서 localhost:4000 으로 접근 가능. 포트 매핑 안하면 localhost에서 못 본다. -d플래그 붙이면 터미널 세션을 꺼도 백그라운드에서 돌아감</span>
$ <span class="token function">docker</span> run <span class="token parameter variable">-p</span> <span class="token number">4000</span>:80 <span class="token parameter variable">--name</span> my-app node-app:0.1
Server running at http://0.0.0.0:80/
</code></pre></div><p>터미널 하나 더 띄워서 다음 명령어 적는다</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">curl</span> http://localhost:4000
Hello World
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 원래 터미널로 돌아가 컨테이너를 멈추고 remove 해준다.</span>
$ <span class="token function">docker</span> stop my-app <span class="token operator">&amp;&amp;</span> <span class="token function">docker</span> <span class="token function">rm</span> my-app

<span class="token comment"># 이번엔 -d 플래그를 붙여 백그라운드에서 띄워준다.</span>
$ <span class="token function">docker</span> run <span class="token parameter variable">-p</span> <span class="token number">4000</span>:80 <span class="token parameter variable">--name</span> my-app <span class="token parameter variable">-d</span> node-app:0.1

<span class="token comment"># 뭐가 돌아가고 있나 확인</span>
$ <span class="token function">docker</span> <span class="token function">ps</span>

<span class="token comment"># 로그는 아래 명령어로 볼 수 있다.</span>
$ <span class="token function">docker</span> logs <span class="token punctuation">[</span>container_id<span class="token punctuation">]</span>
Server running at http://0.0.0.0:80/

<span class="token comment"># app.js를 조금 수정하고, 태그를 0.2로 달아 새로 빌드를 해본다. step2까지는 캐시에서 불러온 걸 볼 수 있다. 3부터는 새로 써진걸로 다시 빌드함.</span>
<span class="token function">docker</span> build <span class="token parameter variable">-t</span> node-app:0.2 <span class="token builtin class-name">.</span>
Step <span class="token number">1</span>/5 <span class="token builtin class-name">:</span> FROM node:6
 ---<span class="token operator">&gt;</span> 67ed1f028e71
Step <span class="token number">2</span>/5 <span class="token builtin class-name">:</span> WORKDIR /app
 ---<span class="token operator">&gt;</span> Using cache
 ---<span class="token operator">&gt;</span> a39c2d73c807
Step <span class="token number">3</span>/5 <span class="token builtin class-name">:</span> ADD <span class="token builtin class-name">.</span> /app
 ---<span class="token operator">&gt;</span> a7087887091f
Removing intermediate container 99bc0526ebb0
Step <span class="token number">4</span>/5 <span class="token builtin class-name">:</span> EXPOSE <span class="token number">80</span>
 ---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> 7882a1e84596
 ---<span class="token operator">&gt;</span> 80f5220880d9
Removing intermediate container 7882a1e84596
Step <span class="token number">5</span>/5 <span class="token builtin class-name">:</span> CMD <span class="token function">node</span> app.js
 ---<span class="token operator">&gt;</span> Running <span class="token keyword">in</span> f2646b475210
 ---<span class="token operator">&gt;</span> 5c3edbac6421
Removing intermediate container f2646b475210
Successfully built 5c3edbac6421
Successfully tagged node-app:0.2

<span class="token comment"># 다른 컨테이너를 다른 포트(8080)으로 띄워본다</span>

$ <span class="token function">docker</span> run <span class="token parameter variable">-p</span> <span class="token number">8080</span>:80 <span class="token parameter variable">--name</span> my-app-2 <span class="token parameter variable">-d</span> node-app:0.2
</code></pre></div><h2 id="디버그-debug"><a href="#디버그-debug" class="header-anchor">#</a> 디버그(Debug)</h2></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/TIL/DevOps/vupress-github-actions.html">
        GitHub Actions로 Vuepress 배포하기
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/TIL/assets/js/app.b135f39f.js" defer></script><script src="/TIL/assets/js/2.3418f87f.js" defer></script><script src="/TIL/assets/js/1.edb52fe5.js" defer></script><script src="/TIL/assets/js/26.f668a394.js" defer></script>
  </body>
</html>
